<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>เกมทดสอบความจำ</title>
    <link rel="stylesheet" href="styles.css">
</head>
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
        background-color: #f0f0f0;
        margin: 0;
        padding: 0;
    }

    .container {
        margin-top: 50px;
    }

    #letter-container {
        font-size: 48px;
        margin: 20px;
    }

    #timer {
        font-size: 24px;
        margin: 20px;
    }

    .buttons {
        margin-top: 20px;
    }

    button {
        font-size: 20px;
        padding: 10px 20px;
        margin: 10px;
        cursor: pointer;
    }

    #scoreboard {
        margin-top: 20px;
    }

    img {
        max-width: 100px;
        max-height: 100px;
    }
</style>

<body>
    <div class="container">
        <h1>เกมทดสอบความจำ</h1>
        <div>
            <label for="game-type">เลือกประเภทเกม:</label>
            <select id="game-type">
                <option value="thai-letters">ตัวอักษรภาษาไทย</option>
                <option value="english-letters">ตัวอักษรภาษาอังกฤษ</option>
                <option value="images">รูปภาพ</option>
            </select>
        </div>
        <div id="letter-container"></div>
        <div id="timer">เวลา: 5</div>
        <div class="buttons">
            <button id="yes-btn" disabled>ใช่</button>
            <button id="no-btn" disabled>ไม่</button>
        </div>
        <div id="message"></div>
        <div id="scoreboard"></div>
        <button id="start-btn">เริ่มเกมใหม่</button>
    </div>
    <script>
        const thaiLetters = ['ก', 'ข', 'ค', 'ฆ', 'ง', 'จ', 'ฉ', 'ช', 'ซ', 'ญ', 'ด', 'ต', 'ถ', 'ท', 'น', 'บ', 'ป', 'ผ', 'พ', 'ฟ', 'ม', 'ย', 'ร', 'ล', 'ว', 'ศ', 'ษ', 'ส', 'ห', 'อ'];
        const englishLetters = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];
        const images = ['image1.jpg', 'image2.jpg', 'image3.jpg', 'image4.jpg', 'image5.jpg']; // Add the paths to your images here

        let currentItem = '';
        let previousItem = '';
        let score = 0;
        let correctAnswers = 0;
        let wrongAnswers = 0;
        let rounds = 0;
        const totalRounds = 20;
        const yesRounds = 6;
        let scheduledYesRounds;
        let timer;
        let countdown;
        let gameType = 'thai-letters';

        const letterContainer = document.getElementById('letter-container');
        const yesBtn = document.getElementById('yes-btn');
        const noBtn = document.getElementById('no-btn');
        const message = document.getElementById('message');
        const scoreboard = document.getElementById('scoreboard');
        const startBtn = document.getElementById('start-btn');
        const timerDisplay = document.getElementById('timer');
        const gameTypeSelect = document.getElementById('game-type');

        gameTypeSelect.addEventListener('change', () => {
            gameType = gameTypeSelect.value;
        });

        function getRandomItem() {
            if (gameType === 'thai-letters') {
                return thaiLetters[Math.floor(Math.random() * thaiLetters.length)];
            } else if (gameType === 'english-letters') {
                return englishLetters[Math.floor(Math.random() * englishLetters.length)];
            } else if (gameType === 'images') {
                return images[Math.floor(Math.random() * images.length)];
            }
        }

        function scheduleYesRounds() {
            let yesRounds = new Set();
            while (yesRounds.size < 6) {
                yesRounds.add(Math.floor(Math.random() * (totalRounds - 1)) + 1); // ตั้งค่าให้เป็น "ใช่" อย่างน้อย 6 รอบ
            }
            return yesRounds;
        }

        function startGame() {
            score = 0;
            correctAnswers = 0;
            wrongAnswers = 0;
            rounds = 0;
            scheduledYesRounds = scheduleYesRounds();
            startBtn.disabled = true;
            nextRound(true);
        }

        function nextRound(isFirstRound = false) {
            clearTimeout(timer);
            clearInterval(countdown);
            if (rounds >= totalRounds) {
                endGame();
                return;
            }
            previousItem = currentItem;
            if (scheduledYesRounds.has(rounds)) {
                currentItem = previousItem;
            } else {
                currentItem = getRandomItem();
                while (currentItem === previousItem) {
                    currentItem = getRandomItem();
                }
            }
            if (gameType === 'images') {
                letterContainer.innerHTML = `<img src="${currentItem}" alt="Image">`;
            } else {
                letterContainer.textContent = currentItem;
            }
            message.textContent = '';
            rounds++;

            if (isFirstRound) {
                yesBtn.disabled = true;
                noBtn.disabled = true;
                timerDisplay.textContent = 'เวลา: 5';
                countdown = startCountdown(5, () => {
                    yesBtn.disabled = false;
                    noBtn.disabled = false;
                    nextRound();
                });
            } else {
                timerDisplay.textContent = 'เวลา: 5';
                countdown = startCountdown(5, () => {
                    handleAnswer(false, true);
                });
            }
        }

        function startCountdown(seconds, callback) {
            let remainingTime = seconds;
            timerDisplay.textContent = `เวลา: ${remainingTime}`;
            const interval = setInterval(() => {
                remainingTime--;
                timerDisplay.textContent = `เวลา: ${remainingTime}`;
                if (remainingTime <= 0) {
                    clearInterval(interval);
                    callback();
                }
            }, 1000);
            return interval;
        }

        function handleAnswer(isCorrect, isTimeout = false) {
            clearInterval(countdown);
            if (isCorrect) {
                correctAnswers++;
                message.textContent = 'ถูกต้อง!';
            } else {
                wrongAnswers++;
                message.textContent = isTimeout ? 'หมดเวลา!' : 'ผิด!';
            }
            updateScoreboard();
            nextRound();
        }

        function updateScoreboard() {
            scoreboard.textContent = `คะแนน: ${correctAnswers} ถูก: ${correctAnswers} ผิด: ${wrongAnswers}`;
        }

        function endGame() {
            message.textContent = `เกมจบแล้ว! คะแนนสุดท้าย: ${correctAnswers} จากทั้งหมด ${totalRounds} รอบ`;
            startBtn.disabled = false;
        }

        yesBtn.addEventListener('click', () => {
            clearTimeout(timer);
            clearInterval(countdown);
            handleAnswer(currentItem === previousItem);
        });

        noBtn.addEventListener('click', () => {
            clearTimeout(timer);
            clearInterval(countdown);
            handleAnswer(currentItem !== previousItem);
        });

        startBtn.addEventListener('click', startGame);

    </script>
</body>

</html>